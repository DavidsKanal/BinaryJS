!function(){function r(r){switch(r){case"byte":return 1;case"short":return 2;case"tribyte":return 3;case"int":case"float":return 4;case"double":return 8;default:throw new Error("Incorrect number type '"+r+"'")}}function t(r){switch(r){case 1:return"byte";case 2:return"short";case 3:return"tribyte";case 4:return"int";default:return"double"}}function e(r){return r.charAt(0).toUpperCase()+r.slice(1)}var o=["byte","short","tribyte","int","float","double"],n=["uByte","sByte","uShort","sShort","uTribyte","sTribyte","uInt","sInt","float","double"],a={Boolean:function(){this.encode=function(r){return i.toUByte(r?1:0)},this.decode=function(r){var t="string"==typeof r?{val:r}:r,e=1===i.fromUByte(t.val.charAt(0));return t.val=t.val.slice(1),e}},Number:function(t){if(t=t||"double",-1===n.indexOf(t))throw new Error("Incorrect Number type '"+t+"'");var o=r(("double"!==t&&"float"!==t?t.slice(1):t).toLowerCase());this.encode=function(r){return i["to"+e(t)](r)},this.decode=function(r){var n="string"==typeof r?{val:r}:r,a=i["from"+e(t)](n.val.slice(0,o));return n.val=n.val.slice(o),a}},String:function(t){if("nullTer"!==(t=t||"nullTer")&&-1===o.indexOf(t))throw new Error("Incorrect String size number type '"+t+"'");this.encode=function(o){return"nullTer"===t?o+String.fromCharCode(0):i["toU"+e(t)](o.length)+o.slice(0,r(t))},this.decode=function(o){var n,a="string"==typeof o?{val:o}:o;if("nullTer"===t)n=a.val.slice(0,a.val.indexOf(String.fromCharCode(0))),a.val=a.val.slice(n.length+1);else{var f=r(t),c=i["fromU"+e(t)](a.val.slice(0,f));n=a.val.slice(f,f+c),a.val=a.val.slice(f+c)}return n}},Object:function(r){this.encode=function(t){var e="";for(var o in r)e+=r[o].encode(t[o]);return e},this.decode=function(t){var e={},o="string"==typeof t?{val:t}:t;for(var n in r)e[n]=r[n].decode(o);return e}},Array:function(t,n){if(n){if(!(o.indexOf(n)>-1))throw new Error("Incorrect Array size number type '"+n+"'");var a=r(n)}this.encode=function(r){var o="";if(n){for(var a=Math.ceil(r.length/t.length),f=0;f<a;f++)for(var c=0;c<t.length;c++)o+=t[c].encode(r[f*t.length+c]);o=i["toU"+e(n)](a)+o}else for(f=0;f<t.length;f++)o+=t[f].encode(r[f]);return o},this.decode=function(r){var o=[],f="string"==typeof r?{val:r}:r;if(n){var c=i["fromU"+e(n)](f.val.slice(0,a));f.val=f.val.slice(a);for(u=0;u<c;u++)for(var h=0;h<t.length;h++)o[u*t.length+h]=t[h].decode(f)}else for(var u=0;u<t.length;u++)o[u]=t[u].decode(f);return o}},Dynamic:function(o){var n=Object.keys(o),a=Math.ceil(Math.log2(n.length)/8)||1,f=t(a);a=r(f),this.encode=function(r){return i["to"+("double"!==f?"U":"")+e(f)](n.indexOf(r.key))+o[r.key].encode(r.value)},this.decode=function(r){var t="string"==typeof r?{val:r}:r,c=n[i["from"+("double"!==f?"U":"")+e(f)](t.val.slice(0,a))];return t.val=t.val.slice(a),{key:c,value:o[c].decode(t)}}}},i={fromUByte:function(r){return r.charCodeAt(0)},toUByte:function(r){return r=Math.round(r),String.fromCharCode(r)},fromUShort:function(r){return 256*r.charCodeAt(0)+r.charCodeAt(1)},toUShort:function(r){return r=Math.round(r),String.fromCharCode(Math.floor(r/256))+String.fromCharCode(r%256)},fromUTribyte:function(r){return 65536*r.charCodeAt(0)+256*r.charCodeAt(1)+r.charCodeAt(2)},toUTribyte:function(r){return r=Math.round(r),String.fromCharCode(Math.floor(r/65536))+String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256)},fromUInt:function(r){return 16777216*r.charCodeAt(0)+65536*r.charCodeAt(1)+256*r.charCodeAt(2)+r.charCodeAt(3)},toUInt:function(r){return r=Math.round(r),String.fromCharCode(Math.floor(r/16777216))+String.fromCharCode(Math.floor(r%16777216/65536))+String.fromCharCode(Math.floor(r%65536/256))+String.fromCharCode(r%256)},fromSByte:function(r){return this.fromUByte(r)-128},toSByte:function(r){return this.toUByte(r+128)},fromSShort:function(r){return this.fromUShort(r)-32768},toSShort:function(r){return this.toUShort(r+32768)},fromSTribyte:function(r){return this.fromUTribyte(r)-8388608},toSTribyte:function(r){return this.toUTribyte(r+8388608)},fromSInt:function(r){return this.fromUInt(r)-2147483648},toSInt:function(r){return this.toUInt(r+2147483648)},fromFloat:function(r){var t=r.charCodeAt(0)%128*2+(r.charCodeAt(1)>=128?1:0)-127,e=r.charCodeAt(0)>=128?-1:1;if(-127===t)return 0*e;if(128===t)return 0==(64&r.charCodeAt(1))?1/0*e:NaN;var o=1;return o+=r.charCodeAt(1)%128/128,o+=r.charCodeAt(2)/128/256,o+=r.charCodeAt(3)/128/256/256,e*Math.pow(2,t)*o},toFloat:function(r){if(0===r)return String.fromCharCode(1/r>0?0:128)+"\0\0\0";if(isNaN(r))return"À\0\0";var t=Math.abs(r),e=Math.min(128,Math.max(-127,Math.floor(Math.log2(t))));if(128===e)return String.fromCharCode(127+(r>0?0:128))+"\0\0";var o=e+127,n=128*(t/Math.pow(2,e)-1),a=0|n,i=String.fromCharCode((r>0?0:128)+(o>>>1))+String.fromCharCode(o%2*128+a);return n=256*(n-a),a=0|n,i+=String.fromCharCode(a),n=256*(n-a),i+=String.fromCharCode(0|n)},fromDouble:function(r){var t=r.charCodeAt(0)%128*16+(240&r.charCodeAt(1))/16-1023,e=r.charCodeAt(0)>=128?-1:1;if(-1023===t)return 0*e;if(1024===t)return 0==(8&r.charCodeAt(1))?1/0*e:NaN;var o=1;return o+=r.charCodeAt(1)%16/16,o+=r.charCodeAt(2)/16/256,o+=r.charCodeAt(3)/16/256/256,o+=r.charCodeAt(4)/16/256/256/256,o+=r.charCodeAt(5)/16/256/256/256/256,o+=r.charCodeAt(6)/16/256/256/256/256/256,o+=r.charCodeAt(7)/16/256/256/256/256/256/256,e*Math.pow(2,t)*o},toDouble:function(r){if(0===r)return String.fromCharCode(1/r>0?0:128)+"\0\0\0\0\0\0\0";if(isNaN(r))return"ø\0\0\0\0\0\0";var t=Math.abs(r),e=Math.min(1024,Math.max(-1023,Math.floor(Math.log2(t))));if(1024===e)return String.fromCharCode(127+(r>0?0:128))+"ð\0\0\0\0\0\0";var o=e+1023,n=16*(t/Math.pow(2,e)-1),a=0|n,i=String.fromCharCode((r>0?0:128)+(o>>>4))+String.fromCharCode(o%16*16+a);return n=256*(n-a),a=0|n,i+=String.fromCharCode(a),n=256*(n-a),a=0|n,i+=String.fromCharCode(a),n=256*(n-a),a=0|n,i+=String.fromCharCode(a),n=256*(n-a),a=0|n,i+=String.fromCharCode(a),n=256*(n-a),a=0|n,i+=String.fromCharCode(a),n=256*(n-a),i+=String.fromCharCode(0|n)}};"object"==typeof module&&"object"==typeof module.exports?module.exports=a:"undefined"!=typeof window?window.binary=a:this.binary=a}();
