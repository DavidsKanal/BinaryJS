!function(){var u={byte:256,short:65536,tribyte:16777216,int:4294967296,float:16777217,double:Number.MAX_SAFE_INTEGER},t=["byte","short","tribyte","int","float","double"],r=["uByte","sByte","uShort","sShort","uTribyte","sTribyte","uInt","sInt","float","double"];function c(r){switch(r){case"byte":return 1;case"short":return 2;case"tribyte":return 3;case"int":case"float":return 4;case"double":return 8;default:throw new Error("Incorrect number type '"+r+"'")}}function e(r){switch(r){case 1:return"byte";case 2:return"short";case 3:return"tribyte";case 4:return"int";default:return"double"}}function o(r,t){return(r%t+t)%t}var n=/^[0-9a-fA-F]+$/;var i={version:"1.5.0",Boolean:function(){this.encode=function(r){return r?"":"\0"},this.decode=function(r){var t="string"==typeof r?{val:r}:r,e=1===t.val.charCodeAt(0);return t.val=t.val.slice(1),e}},Number:function(o){if(o=o||"double",-1===r.indexOf(o))throw new Error("Incorrect Number type '"+o+"'");var n=c(("double"!==o&&"float"!==o?o.slice(1):o).toLowerCase());this.encode=function(r){return s.to[o](r)},this.decode=function(r){var t="string"==typeof r?{val:r}:r,e=s.from[o](t.val.slice(0,n));return t.val=t.val.slice(n),e}},String:function(r){var i="number"==typeof r;if(i){if((r=Math.floor(r))<0)throw new Error("String cannot have a fixed length shorter than 0");var a=r}else{var h=r||"nullTer";if("nullTer"!==h&&-1===t.indexOf(h))throw new Error("Incorrect String size number type '"+h+"'")}this.encode=function(r){if(i){if(r.length===a)return r;throw new Error("Passed string isn't of specified length "+a+"!")}return"nullTer"===h?(-1!==r.indexOf("\0")&&r.replace(/\u0000/g," "),r+"\0"):(r=r.slice(0,u[h]-1),s.to[h](r.length)+r)},this.decode=function(r){var t,e="string"==typeof r?{val:r}:r;if(i)t=e.val.slice(0,a),e.val=e.val.slice(a);else if("nullTer"===h)t=e.val.slice(0,e.val.indexOf("\0")),e.val=e.val.slice(t.length+1);else{var o=c(h),n=s.from[h](e.val.slice(0,o));t=e.val.slice(o,o+n),e.val=e.val.slice(o+n)}return t}},HexString:function(f){var l="number"==typeof f;if(l&&(f=Math.floor(f))<0)throw new Error("HexString cannot have a fixed length shorter than 0");this.encode=function(r){if(t=r,!n.test(t))throw new Error("Passed string is not a HexString!");var t;if(l&&r.length!==f)throw new Error("Passed string isn't of specified length "+f+"!");var e="";l||(e+=String.fromCharCode(r.length%2==0?1:0));for(var o=0;o<r.length;o+=2)e+=String.fromCharCode(parseInt(r.substr(o,2<=r.length-o?2:1),16));return l||(e+="Ā"),e},this.decode=function(r){var t,e="string"==typeof r?{val:r}:r;if(l)t=e.val.slice(0,Math.ceil(f/2));else{var o=1===e.val.charCodeAt(0),n=e.val.indexOf("Ā");t=e.val.slice(1,n)}for(var i="",a=0;a<t.length;a++)if(a!==t.length-1)i+=("00"+t.charCodeAt(a).toString(16)).slice(-2);else{var h=!1;l||o||(h=!0),l&&f%2==1&&(h=!0),i+=h?t.charCodeAt(a).toString(16):("00"+t.charCodeAt(a).toString(16)).slice(-2)}return e.val=e.val.slice(t.length+(l?0:2)),i}},Object:function(a,h){var f=Object.keys(a);if(f.sort(),h){var l=Math.ceil(Math.log2(f.length)/8)||1,u=e(l);l=c(u)}this.encode=function(r){var t="";if(h)for(var e in t+=s.to[u](Object.keys(r).length),r){if(void 0===a[e])throw new Error("Key '"+e+"' is not defined in the blueprint!");t+=s.to[u](f.indexOf(e))+a[e].encode(r[e])}else for(var o=0;o<f.length;o++){if(void 0===r[e=f[o]])throw new Error("Key '"+e+"' is defined in the blueprint, but not in the input object!");t+=a[e].encode(r[e])}return t},this.decode=function(r){var t={},e="string"==typeof r?{val:r}:r;if(h){var o=s.from[u](e.val.slice(0,l));e.val=e.val.slice(l);for(n=0;n<o;n++){i=f[s.from[u](e.val.slice(0,l))];e.val=e.val.slice(l),t[i]=a[i].decode(e)}}else for(var n=0;n<f.length;n++){var i;t[i=f[n]]=a[i].decode(e)}return t}},Array:function(a,h){if(void 0!==h){var f="number"==typeof h;if(f){if((h=Math.floor(h))<0)throw new Error("Array cannot have a fixed length shorter than 0")}else{if(!(-1<t.indexOf(h)))throw new Error("Incorrect Array size number type '"+h+"'");var l=c(h)}}this.encode=function(r){if(r.length%a.length!=0)throw new Error("Array (length "+r.length+") contains at least one incomplete pattern!");var t="";if(void 0!==h){if(f){if(r.length!==h*a.length)throw new Error("Array pattern in the input isn't repeated exactly "+h+" times, as was specified")}else r=r.slice(0,(u[h]-1)*a.length);for(var e=Math.ceil(r.length/a.length),o=0;o<e;o++)for(var n=0;n<a.length;n++)t+=a[n].encode(r[o*a.length+n]);f||(t=s.to[h](e)+t)}else for(o=0;o<a.length;o++)t+=a[o].encode(r[o]);return t},this.decode=function(r){var t=[],e="string"==typeof r?{val:r}:r;if(h){var o;f?o=h:(o=s.from[h](e.val.slice(0,l)),e.val=e.val.slice(l));for(var n=0;n<o;n++)for(var i=0;i<a.length;i++)t[n*a.length+i]=a[i].decode(e)}else for(n=0;n<a.length;n++)t[n]=a[n].decode(e);return t}},Dynamic:function(n){var i=Object.keys(n);i.sort();var o=Math.ceil(Math.log2(i.length)/8)||1,a=e(o);o=c(a),this.encode=function(r,t){var e,o;if(void 0!==t?(e=r,o=t):(e=r.key,o=r.value),void 0===n[e])throw new Error("Key '"+e+"' is not defined!");return s.to[a](i.indexOf(e))+(null===n[e]?"":n[e].encode(o))},this.decode=function(r){var t="string"==typeof r?{val:r}:r,e=i[s.from[a](t.val.slice(0,o))];return t.val=t.val.slice(o),{key:e,value:null===n[e]?null:n[e].decode(t)}}},NullWrapper:function(o){this.encode=function(r){return null===r?"\0":""+o.encode(r)},this.decode=function(r){var t="string"==typeof r?{val:r}:r,e=0===t.val.charCodeAt(0);return t.val=t.val.slice(1),e?null:o.decode(t)}}},s={to:{uByte:function(r){return r=o(Math.round(r),u.byte),String.fromCharCode(r)},uShort:function(r){return r=o(Math.round(r),u.short),String.fromCharCode(Math.floor(r/u.byte))+String.fromCharCode(r%u.byte)},uTribyte:function(r){return r=o(Math.round(r),u.tribyte),String.fromCharCode(Math.floor(r/u.short))+String.fromCharCode(Math.floor(r%u.short/u.byte))+String.fromCharCode(r%u.byte)},uInt:function(r){return r=o(Math.round(r),u.int),String.fromCharCode(Math.floor(r/u.tribyte))+String.fromCharCode(Math.floor(r%u.tribyte/u.short))+String.fromCharCode(Math.floor(r%u.short/u.byte))+String.fromCharCode(r%u.byte)},sByte:function(r){return this.uByte(r+u.byte/2)},sShort:function(r){return this.uShort(r+u.short/2)},sTribyte:function(r){return this.uTribyte(r+u.tribyte/2)},sInt:function(r){return this.uInt(r+u.int/2)},float:function(r){if(0===r)return String.fromCharCode(0<1/r?0:128)+"\0\0\0";if(isNaN(r))return"À\0\0";var t=Math.abs(r),e=Math.min(128,Math.max(-127,Math.floor(Math.log2(t))));if(128===e)return String.fromCharCode(127+(0<r?0:128))+"\0\0";var o=e+127,n=128*(t/Math.pow(2,e)-1),i=0|n,a=String.fromCharCode((0<r?0:128)+(o>>>1))+String.fromCharCode(o%2*128+i);return i=0|(n=256*(n-i)),a+=String.fromCharCode(i),n=256*(n-i),a+=String.fromCharCode(0|n)},double:function(r){if(0===r)return String.fromCharCode(0<1/r?0:128)+"\0\0\0\0\0\0\0";if(isNaN(r))return"ø\0\0\0\0\0\0";var t=Math.abs(r),e=Math.min(1024,Math.max(-1023,Math.floor(Math.log2(t))));if(1024===e)return String.fromCharCode(127+(0<r?0:128))+"ð\0\0\0\0\0\0";var o=e+1023,n=16*(t/Math.pow(2,e)-1),i=0|n,a=String.fromCharCode((0<r?0:128)+(o>>>4))+String.fromCharCode(o%16*16+i);return i=0|(n=256*(n-i)),a+=String.fromCharCode(i),i=0|(n=256*(n-i)),a+=String.fromCharCode(i),i=0|(n=256*(n-i)),a+=String.fromCharCode(i),i=0|(n=256*(n-i)),a+=String.fromCharCode(i),i=0|(n=256*(n-i)),a+=String.fromCharCode(i),n=256*(n-i),a+=String.fromCharCode(0|n)}},from:{uByte:function(r){return o(r.charCodeAt(0),u.byte)},uShort:function(r){return o(r.charCodeAt(0)*u.byte+r.charCodeAt(1),u.short)},uTribyte:function(r){return o(r.charCodeAt(0)*u.short+r.charCodeAt(1)*u.byte+r.charCodeAt(2),u.tribyte)},uInt:function(r){return o(r.charCodeAt(0)*u.tribyte+r.charCodeAt(1)*u.short+r.charCodeAt(2)*u.byte+r.charCodeAt(3),u.int)},sByte:function(r){return this.uByte(r)-u.byte/2},sShort:function(r){return this.uShort(r)-u.short/2},sTribyte:function(r){return this.uTribyte(r)-u.tribyte/2},sInt:function(r){return this.uInt(r)-u.int/2},float:function(r){var t=r.charCodeAt(0)%128*2+(128<=r.charCodeAt(1)?1:0)-127,e=128<=r.charCodeAt(0)?-1:1;if(-127===t)return 0*e;if(128===t)return 0==(64&r.charCodeAt(1))?1/0*e:NaN;var o=1;return o+=r.charCodeAt(1)%128/128,o+=r.charCodeAt(2)/128/256,o+=r.charCodeAt(3)/128/256/256,e*Math.pow(2,t)*o},double:function(r){var t=r.charCodeAt(0)%128*16+(240&r.charCodeAt(1))/16-1023,e=128<=r.charCodeAt(0)?-1:1;if(-1023===t)return 0*e;if(1024===t)return 0==(8&r.charCodeAt(1))?1/0*e:NaN;var o=1;return o+=r.charCodeAt(1)%16/16,o+=r.charCodeAt(2)/16/256,o+=r.charCodeAt(3)/16/256/256,o+=r.charCodeAt(4)/16/256/256/256,o+=r.charCodeAt(5)/16/256/256/256/256,o+=r.charCodeAt(6)/16/256/256/256/256/256,o+=r.charCodeAt(7)/16/256/256/256/256/256/256,e*Math.pow(2,t)*o}}};s.to.byte=s.to.uByte,s.to.short=s.to.uShort,s.to.tribyte=s.to.uTribyte,s.to.int=s.to.uInt,s.from.byte=s.from.uByte,s.from.short=s.from.uShort,s.from.tribyte=s.from.uTribyte,s.from.int=s.from.uInt,"object"==typeof module&&"object"==typeof module.exports?module.exports=i:"undefined"!=typeof window?window.binary=i:this.binary=i}();