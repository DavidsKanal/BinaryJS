!function(){var c={byte:256,short:65536,tribyte:16777216,int:4294967296,float:16777217,double:Number.MAX_SAFE_INTEGER},t=["byte","short","tribyte","int","float","double"],r=["uByte","sByte","uShort","sShort","uTribyte","sTribyte","uInt","sInt","float","double"];function d(r){switch(r){case"byte":return 1;case"short":return 2;case"tribyte":return 3;case"int":case"float":return 4;case"double":return 8;default:throw new Error("Incorrect number type '"+r+"'")}}function e(r){switch(r){case 1:return"byte";case 2:return"short";case 3:return"tribyte";case 4:return"int";default:return"double"}}function o(r,t){return(r%t+t)%t}var n=/^[0-9a-fA-F]+$/;var s=0,i={version:"2.0.2",Boolean:function(){this.encode=function(r){return r?"":"\0"},this.decode=function(r,t){return!0!==t&&(s=0),1===r.charCodeAt(s++)}},Number:function(o){if(o=o||"double",-1===r.indexOf(o))throw new Error("Incorrect Number type '"+o+"'");var n=d(("double"!==o&&"float"!==o?o.slice(1):o).toLowerCase());this.encode=function(r){return l.to[o](r)},this.decode=function(r,t){!0!==t&&(s=0);var e=l.from[o](r.substr(s,n));return s+=n,e}},String:function(r){var i="number"==typeof r;if(i){if((r=Math.floor(r))<0)throw new Error("String cannot have a fixed length shorter than 0");var h=r}else{var u=r||"nullTer";if("nullTer"!==u&&-1===t.indexOf(u))throw new Error("Incorrect String size number type '"+u+"'")}this.encode=function(r){if(i){if(r.length===h)return r;throw new Error("Passed string isn't of specified length "+h+"!")}return"nullTer"===u?(-1!==r.indexOf("\0")&&r.replace(/\u0000/g," "),r+"\0"):(r=r.slice(0,c[u]-1),l.to[u](r.length)+r)},this.decode=function(r,t){var e;if(!0!==t&&(s=0),i)e=r.substr(s,h),s+=h;else if("nullTer"===u)e=r.slice(s,r.indexOf("\0",s)),s+=e.length+1;else{var o=d(u),n=l.from[u](r.substr(s,o));e=r.substr(s+o,n),s+=o+n}return e}},HexString:function(a){var f="number"==typeof a;if(f&&(a=Math.floor(a))<0)throw new Error("HexString cannot have a fixed length shorter than 0");this.encode=function(r){if(t=r,!n.test(t))throw new Error("Passed string is not a HexString!");var t;if(f&&r.length!==a)throw new Error("Passed string isn't of specified length "+a+"!");var e="";f||(e+=String.fromCharCode(r.length%2==0?1:0));for(var o=0;o<r.length;o+=2)e+=String.fromCharCode(parseInt(r.substr(o,2<=r.length-o?2:1),16));return f||(e+="Ā"),e},this.decode=function(r,t){var e;if(!0!==t&&(s=0),f)e=r.substr(s,Math.ceil(a/2));else{var o=1===r.charCodeAt(s),n=r.indexOf("Ā",s);e=r.slice(s+1,n)}for(var i="",h=0;h<e.length;h++)if(h!==e.length-1)i+=("00"+e.charCodeAt(h).toString(16)).slice(-2);else{var u=!1;f||o||(u=!0),f&&a%2==1&&(u=!0),i+=u?e.charCodeAt(h).toString(16):("00"+e.charCodeAt(h).toString(16)).slice(-2)}return s+=e.length+(f?0:2),i}},Object:function(h,u){var a=Object.keys(h);if(a.sort(),u){var f=Math.ceil(Math.log2(a.length)/8)||1,c=e(f);f=d(c)}this.encode=function(r){var t="";if(u){var e=0;for(var o in r)void 0!==h[o]&&(t+=l.to[c](a.indexOf(o))+h[o].encode(r[o]),e++);t=l.to[c](e)+t}else for(var n=0;n<a.length;n++){if(void 0===r[o=a[n]])throw new Error("Key '"+o+"' is defined in the blueprint, but not in the input object!");t+=h[o].encode(r[o])}return t},this.decode=function(r,t){!0!==t&&(s=0);var e={};if(u){var o=l.from[c](r.substr(s,f));s+=f;for(n=0;n<o;n++){i=a[l.from[c](r.substr(s,f))];s+=f,e[i]=h[i].decode(r,!0)}}else for(var n=0;n<a.length;n++){var i;e[i=a[n]]=h[i].decode(r,!0)}return e}},Array:function(h,u){if(void 0!==u){var a="number"==typeof u;if(a){if((u=Math.floor(u))<0)throw new Error("Array cannot have a fixed length shorter than 0")}else{if(!(-1<t.indexOf(u)))throw new Error("Incorrect Array size number type '"+u+"'");var f=d(u)}}this.encode=function(r){if(r.length%h.length!=0)throw new Error("Array (length "+r.length+") contains at least one incomplete pattern!");var t="";if(void 0!==u){if(a){if(r.length!==u*h.length)throw new Error("Array pattern in the input isn't repeated exactly "+u+" times, as was specified")}else r=r.slice(0,(c[u]-1)*h.length);for(var e=Math.ceil(r.length/h.length),o=0;o<e;o++)for(var n=0;n<h.length;n++)t+=h[n].encode(r[o*h.length+n]);a||(t=l.to[u](e)+t)}else for(o=0;o<h.length;o++)t+=h[o].encode(r[o]);return t},this.decode=function(r,t){!0!==t&&(s=0);var e=[];if(u){var o;a?o=u:(o=l.from[u](r.substr(s,f)),s+=f);for(var n=0;n<o;n++)for(var i=0;i<h.length;i++)e[n*h.length+i]=h[i].decode(r,!0)}else for(n=0;n<h.length;n++)e[n]=h[n].decode(r,!0);return e}},Dynamic:function(n){var i=Object.keys(n);i.sort();var o=Math.ceil(Math.log2(i.length)/8)||1,h=e(o);o=d(h),this.encode=function(r,t){var e,o;if(void 0!==t?(e=r,o=t):(e=r.key,o=r.value),void 0===n[e])throw new Error("Key '"+e+"' is not defined!");return l.to[h](i.indexOf(e))+(null===n[e]?"":n[e].encode(o))},this.decode=function(r,t){!0!==t&&(s=0);var e=i[l.from[h](r.slice(s,o))];return s+=o,{key:e,value:null===n[e]?null:n[e].decode(r,!0)}}},NullWrapper:function(e){this.encode=function(r){return null===r?"\0":""+e.encode(r)},this.decode=function(r,t){return!0!==t&&(s=0),0===r.charCodeAt(s++)?null:e.decode(r,!0)}}},h=new ArrayBuffer(8),u=new Uint8Array(h),a=new Float32Array(h),f=new Float64Array(h),l={to:{uByte:function(r){return r=o(Math.round(r),c.byte),String.fromCharCode(r)},uShort:function(r){return r=o(Math.round(r),c.short),String.fromCharCode(Math.floor(r/c.byte))+String.fromCharCode(r%c.byte)},uTribyte:function(r){return r=o(Math.round(r),c.tribyte),String.fromCharCode(Math.floor(r/c.short))+String.fromCharCode(Math.floor(r%c.short/c.byte))+String.fromCharCode(r%c.byte)},uInt:function(r){return r=o(Math.round(r),c.int),String.fromCharCode(Math.floor(r/c.tribyte))+String.fromCharCode(Math.floor(r%c.tribyte/c.short))+String.fromCharCode(Math.floor(r%c.short/c.byte))+String.fromCharCode(r%c.byte)},sByte:function(r){return this.uByte(r+c.byte/2)},sShort:function(r){return this.uShort(r+c.short/2)},sTribyte:function(r){return this.uTribyte(r+c.tribyte/2)},sInt:function(r){return this.uInt(r+c.int/2)},float:function(r){return a[0]=r,String.fromCharCode(u[0])+String.fromCharCode(u[1])+String.fromCharCode(u[2])+String.fromCharCode(u[3])},double:function(r){return f[0]=r,String.fromCharCode(u[0])+String.fromCharCode(u[1])+String.fromCharCode(u[2])+String.fromCharCode(u[3])+String.fromCharCode(u[4])+String.fromCharCode(u[5])+String.fromCharCode(u[6])+String.fromCharCode(u[7])}},from:{uByte:function(r){return o(r.charCodeAt(0),c.byte)},uShort:function(r){return o(r.charCodeAt(0)*c.byte+r.charCodeAt(1),c.short)},uTribyte:function(r){return o(r.charCodeAt(0)*c.short+r.charCodeAt(1)*c.byte+r.charCodeAt(2),c.tribyte)},uInt:function(r){return o(r.charCodeAt(0)*c.tribyte+r.charCodeAt(1)*c.short+r.charCodeAt(2)*c.byte+r.charCodeAt(3),c.int)},sByte:function(r){return this.uByte(r)-c.byte/2},sShort:function(r){return this.uShort(r)-c.short/2},sTribyte:function(r){return this.uTribyte(r)-c.tribyte/2},sInt:function(r){return this.uInt(r)-c.int/2},float:function(r){return u[0]=r.charCodeAt(0),u[1]=r.charCodeAt(1),u[2]=r.charCodeAt(2),u[3]=r.charCodeAt(3),a[0]},double:function(r){return u[0]=r.charCodeAt(0),u[1]=r.charCodeAt(1),u[2]=r.charCodeAt(2),u[3]=r.charCodeAt(3),u[4]=r.charCodeAt(4),u[5]=r.charCodeAt(5),u[6]=r.charCodeAt(6),u[7]=r.charCodeAt(7),f[0]}}};l.to.byte=l.to.uByte,l.to.short=l.to.uShort,l.to.tribyte=l.to.uTribyte,l.to.int=l.to.uInt,l.from.byte=l.from.uByte,l.from.short=l.from.uShort,l.from.tribyte=l.from.uTribyte,l.from.int=l.from.uInt,"object"==typeof module&&"object"==typeof module.exports?module.exports=i:"undefined"!=typeof window?window.Binarify=i:this.Binarify=i}();