# BinaryJS Reference
In BinaryJS, Converter objects, which define a certain use-specific datatype or structure, have to be created first before any encoding/decoding can be performed.

All Converter objects come with two methods:

---
### Converter.encode(data)
Encodes the given data, which matches the previously defined datatype or structure, into a binary format, stored using the **UTF-8 encoding**. Each character encodes one byte ranging from 0-255. The format of `data` changes with Converter type.

---
### Converter.decode(string)
Decodes the given string, which was generated by encoding data through the same helper object, back into the previously defined datatype or structure. If no errors are made, this output will be exactly equal to the input passed to the `Converter.encode` method. So:
```javascript
Converter.decode(Converter.encode(data)) === data // if data matches the datatype of the Converter
```
# Converter types

There are different types of Converters, each built for their respective datatype/structure:

[binary.Boolean](#binaryboolean)<br>
[binary.Number](#binarynumber)<br>
[binary.String](#binarystring)<br>
[binary.HexString](#binaryhexstring)<br>
[binary.Object](#binaryobject)<br>
[binary.Array](#binaryarray)<br>
[binary.Dynamic](#binarydynamic)<br>
[binary.NullWrapper](#binarynullwrapper)<br>

---
## binary.Boolean
Used for true/false values.<br>
### Instanciation syntax:
```javascript
new binary.Boolean()
```
### Encoding syntax:
```javascript
Converter.encode(boolean)
```
### Example:
```javascript
var bool = new binary.Boolean();
var encodedBool = bool.encode(4 < 7);
```

---
## binary.Number
Used for numbers of the specified bytetype.<br>
### Instanciation syntax:
```javascript
new binary.Number(type)
```
*Arguments:*<br>
- `type` - The bytetype which the number will be encoded in. Accepted values are **uByte**, **sByte**, **uShort**, **sShort**, **uTribyte**, **sTribyte**, **uInt**, **sInt**, **float** and **double**. Defaults to **double**.
### Encoding syntax:
```javascript
Converter.encode(number)
```
### Example:
```javascript
var appleCount = new binary.Number("uShort");
var applesHarvested = appleCount.encode(7415);

var monthlyPay = new binary.Number("float");
var payInJune = monthlyPay.encode(5012.83);
```

---
## binary.String
Used for strings.
### Instanciation syntax:
```javascript
new binary.String(length)
```
*Arguments:*<br>
- `length` - Specifies the bytetype storing the length of the string. Accepted values are **byte**, **short**, **tribyte**, **int**, **float**, **double**, **nullTer** (null-terminated string with no length limit), **or** an integer (used to define a string with *fixed length*). Defaults to **nullTer**.
### Encoding syntax:
```javascript
Converter.encode(string)
```
### Example:
```javascript
var message = new binary.String("short"); // max length: 2^16 - 1
var encodedMessage = message.encode("The quick brown fox jumps over the lazy dog.");

var dateStr = new binary.String(10); // fixed length
var encodedDate = dateStr.encode("24-02-1955");
```

---
## binary.HexString
Used for hexadecimal strings. Stores them in about half the bytesize of what a regular string would require.
### Instanciation syntax:
```javascript
new binary.HexString([length])
```
*Arguments:*<br>
- `length` - *Optional.* Can be used to specify an exact length for the hex string (saves a few bytes).
### Encoding syntax:
```javascript
Converter.encode(hexString)
```
### Example:
```javascript
var SHA1 = new binary.HexString(40); // fixed length of 40
var encodedHash = SHA1.encode("74738ff55367e9589aee98fffdcd187694028007");
``` 

---
## binary.Object
Used for objects matching the predefined structure.
### Instanciation syntax:
```javascript
new binary.Object(blueprint[, loose])
```
*Arguments:*<br>
- `blueprint` - An object of key-value pairs where every value points to a *Converter* object.
- `loose` - *Optional.* Keys can be omitted if this is set to true. Otherwise, every key defined in the blueprint must also be present in the object passed to the `.encode()` method.
### Encoding syntax:
```javascript
Converter.encode(object)
// The structure of the passed object must match that specified within the blueprint.
```
### Example:
```javascript
var personBlueprint = new binary.Object({
    age: new binary.Number("uByte"),
    name: new binary.String(),
    isChild: new binary.Boolean()
});
var person = {
    age: 42,
    name: "John Doe",
    isChild: false
};
var encodedData = personBlueprint.encode(person);
```

---
## binary.Array
Used for arrays matching the predefined pattern.
### Instanciation syntax:
```javascript
new binary.Array(pattern[, repeatSize])
```
*Arguments:*<br>
- `pattern` - An array containing *Converter* objects. The order of these objects will set the pattern for this array.
- `repeatSize` - *Optional.* Specifies the bytetype storing the amount of pattern repitions. Accepted values are **byte**, **short**, **tribyte**, **int**, **float** and **double**. If omitted, only inputs with the same array length as the pattern are accepted.
### Encoding syntax:
```javascript
Converter.encode(array)
// Array structure including its repeats must match the one specified within the pattern.
```
### Example:
```javascript
// Non-repeating
var firstAndLastNamePattern = new binary.Array([new binary.String(), new binary.String()]);
var firstAndLastName = ["John", "Doe"];
var encodedData = firstAndLastNamePattern.encode(firstAndLastName);

// Repeating (single element)
var randomIntegersPattern = new binary.Array([new binary.Number("sInt")], "int");
var randomIntegers = [4, 75, 34, -725, 142, 92];
var encodedData = randomIntegersPattern.encode(randomIntegers);
```

---
## binary.Dynamic
Used for cases in which the programmer can't predetermine or predict the required datatype/structure or where varying types are expected. All possible datatypes have to be predefined and named.
### Instanciation syntax:
```javascript
new binary.Dynamic(pairs)
```
*Arguments:*<br>
- `pairs` - An associative object, where every key points to a Converter object.
### Encoding syntax:
```javascript
Converter.encode({key: desiredKey, value: dataToEncode});
/* Desired key has to be a key of the specified pairs object, and the structure of
   that key's value has to match that of dataToEncode. */
   
Converter.encode(desiredKey, dataToEncode);
/* Alternative, cleaner way of passing key and value. Only works when the Dynamic Converter
   is at the top-most layer of the data structure. */
```
### Example:
```javascript
var chairBlueprint = new binary.Object({height: new binary.Number("float")}),
    tableBlueprint = new binary.Object({area: new binary.Number("float")}),
    lampBlueprint = new binary.Object({color: new binary.String()});
    
var furnitureArray = new binary.Array([new binary.Dynamic({
    chair: chairBlueprint,
    table: tableBlueprint,
    lamp: lampBlueprint
})], "byte");

var encodedData = furnitureArray.encode([
    {key: "chair", value: {height: 0.73}},
    {key: "chair", value: {height: 0.25}},
    {key: "lamp", value: {color: "orange"}},
    {key: "table", value: {area: 2.125}},
    {key: "lamp", value: {color: "white"}}
]);
```
Instead of assigning a key to a Converter, one can also assign it to `null`. This is useful for when the key itself carries meaning and doesn't actually need to hold any additional data.
```javascript
var messageTypes = new binary.Dynamic({
    sayHi: null,
    sayNumber: new binary.Number()
});

function handleMessage(msg) {
    if (msg.key === "sayHi") console.log("Hi");
    if (msg.key === "sayNumber") console.log(msg.value);
}
handleMessage(messageTypes.decode(messageTypes.encode({key: "sayHi" /* 'value' does not need to be specified in this case */})));
```

---
## binary.NullWrapper
Used for cases where null might be passed to the converter, instead of the specified data structure.
### Instanciation syntax:
```javascript
new binary.NullWrapper(converterObject)
```
*Arguments:*<br>
- `converterObject` - Any Converter object. Will be used to encode the data if it isn't null.
### Encoding syntax:
```javascript
Converter.encode(data);
```
### Example:
```javascript
var clientDataBlueprint = new binary.Object({
    firstName: new binary.String(),
    lastName: new binary.String(),
    email: new binary.String(),
    dateOfBirth: new binary.NullWrapper(new binary.Number("uInt")), // This...
    phoneNumber: new binary.NullWrapper(new binary.String()) // ...and this field might be optional
});

var encodedData = clientDataBlueprint.encode({
    firstName: "John",
    lastName: "Doe",
    email: "john.doe@example.com",
    dateOfBirth: null,
    phoneNumber: "123 456 789"
});
```
